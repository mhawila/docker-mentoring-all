var mentoring=angular.module("mentoring",["ui.router","smart-table","pascalprecht.translate","ngCookies","angularSpinners","ui.toggle","ngJsonExportExcel"]);$(function(){$(".menu-icon").bind("click",function(a){$(".sidebar, .content, footer").toggleClass("is-toggled"),a.preventDefault()})}),mentoring.factory("init",["$rootScope","$location","$cookies",function(a,b,c){var d=function(){};return{context:d()}}]),mentoring.config(["$stateProvider","$urlRouterProvider","$translateProvider","$locationProvider",function(a,b,c,d){c.preferredLanguage("pt"),c.useLoader("translateLoad"),c.useSanitizeValueStrategy("escaped"),b.otherwise("/home"),a.state("home",{url:"/home",templateUrl:"home/views/home.html",controller:"homeController",resolve:{init:"init"}}).state("login",{url:"/login",templateUrl:"home/views/login.html",controller:"loginController",resolve:{init:"init"}}).state("createTutor",{url:"/createTutor",templateUrl:"tutor/views/create-tutor.html",controller:"createTutorController",resolve:{init:"init"}}).state("createTutored",{url:"/createTutored",templateUrl:"tutored/views/create-tutored.html",controller:"createTutoredController",resolve:{init:"init"}}).state("listTutor",{url:"/listTutor",templateUrl:"tutor/views/list-tutor.html",controller:"updateTutorController",resolve:{init:"init"}}).state("listTutored",{url:"/listTutored",templateUrl:"tutored/views/list-tutored.html",controller:"updateTutoredController",resolve:{init:"init"}}).state("createProgrammaticArea",{url:"/createProgrammaticArea",templateUrl:"programmatic-area/views/create-programatic-area.html",controller:"createSectorController",resolve:{init:"init"}}).state("listProgrammaticAreas",{url:"/listProgrammaticAreas",templateUrl:"programmatic-area/views/list-programatic-area.html",controller:"updateSectorController",resolve:{init:"init"}}).state("createQuestion",{url:"/createQuestion",templateUrl:"question/views/create-question.html",controller:"createQuestionController",resolve:{init:"init"}}).state("listQuestions",{url:"/listQuestions",templateUrl:"question/views/list-questions.html",controller:"listQuestionsController",resolve:{init:"init"}}).state("form",{url:"/form",templateUrl:"form/views/form-template.html",controller:"formController",resolve:{init:"init"}}).state("form.details",{url:"/form/details",templateUrl:"form/views/form-details.html"}).state("form.questions",{url:"/form/questions",templateUrl:"form/views/form-questions.html"}).state("listFormQuestions",{url:"/form/questions",controller:"listFormController",templateUrl:"form/views/list-form-question.html",resolve:{init:"init"}}).state("mentoringProcess",{url:"/mentoringProcess",templateUrl:"mentoring-process/views/create-mentoring-process.html",controller:"mentoringProcessController",resolve:{init:"init"}}).state("mentoringProcess.questions",{url:"/mentoringProcess/questions/:questionId",templateUrl:"mentoring-process/views/mentoring-process-questions.html",resolve:{init:"init"}}).state("listMentoringProcess",{url:"/mentoringProcess/list",templateUrl:"mentoring-process/views/list-mentoring-process.html",controller:"listMentoringProcessController",resolve:{init:"init"}}).state("formUpdate",{url:"/formUpdate",templateUrl:"form/views/update-form-template.html",controller:"listFormController",resolve:{init:"init"}}).state("formUpdate.updateDetails",{url:"/formUpdate/updateDetails",templateUrl:"form/views/update-form-details.html"}).state("formUpdate.questionsDetails",{url:"/form/questionsDetails",templateUrl:"form/views/update-form-questions.html"}).state("mapTutorToProgrammaticArea",{url:"/mapTutorToProgrammaticArea",templateUrl:"tutor/views/map-tutor-template.html",controller:"mapTutorController",resolve:{init:"init"}}).state("mapTutorToProgrammaticArea.selectTutor",{url:"/mapTutorToProgrammaticArea/selectTutor",templateUrl:"tutor/views/map-tutor-select.html"}).state("mapTutorToProgrammaticArea.mapTutor",{url:"mapTutorToProgrammaticArea.mapTutor",templateUrl:"tutor/views/map-tutor-programmatic-area.html"}).state("sampleIndicatorsReport",{url:"/sampleIndicatorsReport",templateUrl:"reports/views/sample-indicators.html",controller:"sampleIndicatorsController",resolve:{init:"init"}}).state("performedSessionsReport",{url:"/performedSessionsReport",templateUrl:"reports/views/performed-sessions.html",controller:"performedSessionsController",resolve:{init:"init"}}).state("analysisTableReport",{url:"/analysisTableReport",templateUrl:"reports/views/analysis-tables.html",controller:"analysisTablesController",resolve:{init:"init"}})}]).run(["$rootScope","$location","$cookies",function(a,b,c){a.$on("$locationChangeStart",function(d,e,f){var g=c.getObject("usercontext");return"/login"===b.path()||g?("/login"===b.path()&&g&&b.path("/home"),void(g&&(a.visible=!0,a.userContext=g.data))):void b.path("/login")})}]),mentoring.factory("translateLoad",["$q","$http",function(a,b){return function(c){var d,e=a.defer();return b.get("resources/i18n/locale_pt.json").then(function(a){d=a.data,e.resolve(d)}),e.promise}}]),mentoring.service("resourceUtilsService",["requestProcessService",function(a){this.getProvinces=function(){return a.get("/mentoring-integ/services/utils/provinces")},this.getMonths=function(){return a.get("/mentoring-integ/services/utils/months")},this.getQuestionTypes=function(){return a.get("/mentoring-integ/services/utils/questiontypes")},this.getQuestionCategories=function(){return a.get("/mentoring-integ/services/utils/questionscategories")},this.getCarrertypes=function(){return a.get("/mentoring-integ/services/utils/careertypes")},this.getFormTypes=function(){return a.get("/mentoring-integ/services/utils/formtypes")}}]),mentoring.service("requestProcessService",["$http","$q","$filter","spinnerService",function(a,b,c,d){this.get=function(e){return b(function(b,f){d.show("processSpinner"),a.get(e).success(function(a){var c=a.message;return c?void f({data:c}):void b({data:a})}).error(function(a){console.log(a),f({data:c("translate")("CONNECTION_PROBLEMS")})})["finally"](function(){d.hide("processSpinner")})})},this.get=function(e,f){return b(function(b,g){d.show("processSpinner"),a.get(e,{params:f}).success(function(a){var d="";return null==a?void g({data:c("translate")("NO_RESULT_FOUND")}):(d=a.message)?void g({data:d}):void b({data:a})}).error(function(a){console.log(a),g({data:c("translate")("CONNECTION_PROBLEMS")})})["finally"](function(){d.hide("processSpinner")})})},this.post=function(e,f,g){return b(function(b,h){d.show("processSpinner"),a.post(e,f).success(function(a){var c=a.message;return c?void h({data:c}):void b({data:g})}).error(function(a){console.log(a),h({data:c("translate")("CONNECTION_PROBLEMS")})})["finally"](function(){d.hide("processSpinner")})})},this.put=function(e,f,g){return b(function(b,h){d.show("processSpinner"),a.put(e,f).success(function(a){var c=a.message;return c?void h({data:c}):void b({data:g})}).error(function(a){console.log(a),h({data:c("translate")("CONNECTION_PROBLEMS")})})["finally"](function(){d.hide("processSpinner")})})}}]),mentoring.service("districtSevice",["$http",function(a){this.getDistrictsByProvince=function(b){return a.get("/mentoring-integ/services/districts",{params:{province:b}})}}]),mentoring.service("healthFacilityService",["$http",function(a){this.getHealthFacilitiesByDistrictId=function(b){return a.get("/mentoring-integ/services/healthfacilities/"+b)}}]),mentoring.directive("form",function(){return{require:"form",restrict:"E",link:function(a,b,c){var d=$(b);d.on("submit",function(){var b=a[c.name];a.hasErrors=[],angular.forEach(b,function(b,c){"$"!==c[0]&&b.$invalid&&"''"!==b.$name&&a.hasErrors.push({field:"O campo "+c+" deve ser preenchido!"})},this),a.$apply()})}}}),mentoring.directive("datepicker",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){var e=$(b),f=function(b){a.$apply(function(){d.$setViewValue(b)})},g={changeMonth:!0,changeYear:!0,dateFormat:"dd-mm-yy",onSelect:function(a){f(a)}};e.datepicker(g)}}}),mentoring.directive("menu",function(){return{restrict:"A",link:function(a,b,c){$(b).metisMenu()}}}),mentoring.directive("messages",function(){return{require:"form",restrict:"EA",templateUrl:"directives/views/messages-template.html",scope:{message:"@",errorMessage:"@",hasErrors:"="}}}),mentoring.directive("stringToNumber",function(){return{restric:"A",require:"ngModel",link:function(a,b,c,d){d.$parsers.push(function(a){return""+a}),d.$formatters.push(function(a){return parseFloat(a)})}}}),mentoring.directive("stringToInt",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.push(function(a){return""+a}),d.$formatters.push(function(a){return Number.parseInt(a)})}}}),mentoring.controller("createTutorController",["$scope","$rootScope","tutorService","resourceUtilsService","carrerService",function(a,b,c,d,e){var f={userContext:b.userContext};a.carrerType={name:""},a.createTutor=function(){a.createTutorForm.$invalid||(f.tutor=a.tutor,c.createTutor(f).then(function(b){a.message=b.data,a.tutor={}}))},a.cleanTutor=function(){a.tutor={},a.hasErrors=[],a.message="",a.errorMessage=""},a.getCarrertypes=function(){d.getCarrertypes().then(function(b){a.carrertypes=[],a.carrertypes=b.data.careerType})},a.changeValues=function(){a.carres=[],e.getCarrerByCarrerType(a.carrerType.name).then(function(b){if(b.data){if(!Array.isArray(b.data.career))return void a.carres.push(b.data.career);a.carres=b.data.career}})},a.cleanTutor(),a.getCarrertypes()}]),mentoring.controller("updateTutorController",["$scope","$rootScope","tutorService","resourceUtilsService","carrerService",function(a,b,c,d,e){var f={userContext:b.userContext};a.carrerType={name:""},a.getTutorsBySelectedFilter=function(){a.tutors=c.getTutors(a.tutorFilter).then(function(b){if(b.data){if(!Array.isArray(b.data.tutor))return a.tutors=[],a.tutors.push(b.data.tutor),void console.log(a.tutors);a.tutors=b.data.tutor}else a.tutors=[],a.errorMessage="Nenhum tutor encontrado para o filtro solicitado!"})},a.onSelectTutor=function(b){a.message="",a.tutor=b,a.hasErrors=[],a.isDisabled=!1},a.editTutor=function(){a.editTutorForm.$invalid||(a.hasErrors=[],f.tutor=a.tutor,c.updateTutor(f).then(function(b){a.message=b.data,a.isDisabled=!0}))},a.cleanTutor=function(){a.tutorFilter={},a.tutor={},a.tutors=[],a.message="",a.errorMessage="",a.hasErrors=[],a.isDisabled=!1},a.getCarrertypes=function(){d.getCarrertypes().then(function(b){a.carrertypes=[],a.carrertypes=b.data.careerType})},a.changeValues=function(){a.carres=[],e.getCarrerByCarrerType(a.carrerType.name).then(function(b){if(b.data){if(!Array.isArray(b.data.career))return void a.carres.push(b.data.career);a.carres=b.data.career}})},a.cleanTutor(),a.getCarrertypes()}]),mentoring.controller("mapTutorController",["$scope","$filter","$state","$rootScope","tutorService","resourceUtilsService","programmaticAreaService","mapTutorService",function(a,b,c,d,e,f,g,h){a.careerTypes=[],a.tutorFilter={},a.tutors=[],a.errorMessage="",a.message="",a.programmaticAreas=[],a.disabled=!1,a.tutorProgramaticArea={},function(){f.getCarrertypes().then(function(b){a.careerTypes=b.data.careerType})["catch"](function(a){console.log(a)})}(),a.getTutorsBySelectedFilter=function(){a.tutors=[],a.errorMessage="",e.getTutors(a.tutorFilter).then(function(b){a.tutors=b.data.tutor})["catch"](function(b){a.errorMessage=b.data,console.log(b)})},a.cleanMap=function(){a.tutorFilter={},a.tutors=[],a.errorMessage="",a.tutorProgramaticArea={},a.message=""},a.onSelectTutor=function(b){a.tutorProgramaticArea.tutor=b},a.next=function(){return a.errorMessage="",a.disabled=!1,a.message="",a.tutorProgramaticArea.tutor?void g.getProgrammaticAreas({}).then(function(b){a.programmaticAreas=b.data.programmaticArea,c.go("mapTutorToProgrammaticArea.mapTutor")})["catch"](function(a){console.log(a)}):void(a.errorMessage=b("translate")("TUTOR_MUST_BE_SELECTED"))},a.onSelectProgrammaticArea=function(b){a.errorMessage="",a.tutorProgramaticArea.programmaticArea=b},a.save=function(){if(a.errorMessage="",a.message="",!a.tutorProgramaticArea.programmaticArea)return void(a.errorMessage=b("translate")("PROGRAMMATIC_AREA_MUST_BE_SELECTED"));var c={userContext:d.userContext,tutorProgramaticArea:a.tutorProgramaticArea};h.mapTutorToProgrammaticArea(c).then(function(b){a.disabled=!0,a.message=b.data})["catch"](function(b){a.errorMessage=b.data})},a.back=function(){a.errorMessage="",c.go("mapTutorToProgrammaticArea.selectTutor")}}]),mentoring.service("tutorService",["$filter","requestProcessService",function(a,b){this.createTutor=function(c){return b.post("/mentoring-integ/services/tutors",c,a("translate")("TUTOR_CREATED_WITH_SUCCESS"))},this.getTutors=function(a){var c={code:a.code,name:a.name,surname:a.surname,careerType:a.careerType,phoneNumber:a.phoneNumber};return b.get("/mentoring-integ/services/tutors",c)},this.updateTutor=function(c){return b.put("/mentoring-integ/services/tutors",c,a("translate")("TUTOR_EDITED_WITH_SUCCESS"))}}]),mentoring.service("mapTutorService",["$filter","requestProcessService",function(a,b){this.mapTutorToProgrammaticArea=function(c){return b.post("/mentoring-integ/services/tutor-programmatic-areas",c,a("translate")("TUTORED_MAPPED_SUCCESS"))}}]),mentoring.controller("createTutoredController",["$scope","$rootScope","tutoredService","resourceUtilsService","carrerService",function(a,b,c,d,e){var f={userContext:b.userContext};a.carrerType={name:""},a.createTutored=function(){a.createTutoredForm.$invalid||(f.tutored=a.tutored,c.createTutored(f).then(function(b){a.message=b.data,a.tutored={}}))},a.getCarrertypes=function(){d.getCarrertypes().then(function(b){a.carrertypes=[],a.carrertypes=b.data.careerType})},a.onSelectCarrerType=function(){a.carres=[],e.getCarrerByCarrerType(a.carrerType.name).then(function(b){if(b.data){if(!Array.isArray(b.data.career))return void a.carres.push(b.data.career);a.carres=b.data.career}})},a.cleanTutored=function(){a.tutored={},a.hasErrors=[],a.message="",a.errorMessage=""},a.cleanTutored(),a.getCarrertypes()}]),mentoring.controller("updateTutoredController",["$scope","$rootScope","tutoredService","resourceUtilsService","carrerService",function(a,b,c,d,e){var f={userContext:b.userContext};a.carrerType={name:""},a.getTutoredsBySelectedFilter=function(){a.tutoreds=c.getTutoreds(a.tutoredFilter).then(function(b){if(b.data){if(!Array.isArray(b.data.tutored))return a.tutoreds=[],a.tutoreds.push(b.data.tutored),void console.log(b.data.tutored);a.tutoreds=b.data.tutored}else a.tutoreds=[],a.errorMessage="Nenhum Tutorando encontrado para o filtro solicitado!"})},a.onSelectTutored=function(b){a.message="",a.tutored=b,a.hasErrors=[],a.isDisabled=!1},a.editTutored=function(){a.editTutoredForm.$invalid||(a.hasErrors=[],f.tutored=a.tutored,c.updateTutored(f).then(function(b){a.message=b.data,a.isDisabled=!0}))},a.cleanTutored=function(){a.tutoredFilter={},a.tutored={},a.tutoreds=[],a.message="",a.errorMessage="",a.hasErrors=[],a.isDisabled=!1},a.getCarrertypes=function(){d.getCarrertypes().then(function(b){a.carrertypes=[],a.carrertypes=b.data.careerType})},a.onSelectCarrerType=function(){a.carres=[],e.getCarrerByCarrerType(a.carrerType.name).then(function(b){if(b.data){if(!Array.isArray(b.data.career))return void a.carres.push(b.data.career);a.carres=b.data.career}})},a.cleanTutored(),a.getCarrertypes()}]),mentoring.service("tutoredService",["$filter","requestProcessService",function(a,b){this.createTutored=function(c){return b.post("/mentoring-integ/services/tutoreds",c,a("translate")("TUTORED_CREATED_WITH_SUCCESS"))},this.getTutoreds=function(a){var c={code:a.code,name:a.name,surname:a.surname,phoneNumber:a.phoneNumber};return b.get("/mentoring-integ/services/tutoreds",c)},this.updateTutored=function(c){return b.put("/mentoring-integ/services/tutoreds",c,a("translate")("TUTORED_EDITED_WITH_SUCCESS"))}}]),mentoring.controller("createSectorController",["$scope","$rootScope","programmaticAreaService",function(a,b,c){var d={userContext:b.userContext};a.createProgrammaticArea=function(){a.createProgrammaticAreaForm.$invalid||(d.programmaticArea=a.programmaticArea,c.createProgrammaticArea(d).then(function(b){a.message=b.data,a.programmaticArea={}}))},a.cleanProgrammaticArea=function(){a.programmaticArea={},a.hasErrors=[],a.message="",a.errorMessage=""},a.cleanProgrammaticArea()}]),mentoring.controller("updateSectorController",["$scope","$rootScope","programmaticAreaService",function(a,b,c){var d={userContext:b.userContext};a.getProgrammaticAreasBySelectedFilter=function(){a.programmaticAreas=c.getProgrammaticAreas(a.programmaticAreaFilter).then(function(b){if(b.data){if(!Array.isArray(b.data.programmaticArea))return a.programmaticAreas=[],void a.programmaticAreas.push(b.data.programmaticArea);a.programmaticAreas=b.data.programmaticArea}else a.programmaticAreas=[],a.errorMessage="Nenhuma Area Programatica foi encontrada para o filtro solicitado!"})},a.onSelectprogrammaticArea=function(b){a.message="",a.programmaticArea=b,a.hasErrors=[],a.isDisabled=!1},a.editProgrammaticArea=function(){a.editprogrammaticAreaForm.$invalid||(a.hasErrors=[],d.programmaticArea=a.programmaticArea,c.updateProgrammaticArea(d).then(function(b){a.message=b.data,a.isDisabled=!0}))},a.cleanProgrammaticArea=function(){a.programmaticAreaFilter={},a.programmaticArea={},a.programmaticAreas=[],a.message="",a.errorMessage="",a.hasErrors=[],a.isDisabled=!1},a.cleanProgrammaticArea()}]),mentoring.service("programmaticAreaService",["$filter","requestProcessService",function(a,b){this.createProgrammaticArea=function(c){return b.post("/mentoring-integ/services/programmaticareas",c,a("translate")("AREA_CREATED_WITH_SUCCESS"))},this.getProgrammaticAreas=function(a){var c={};return a&&(c={code:a.code,name:a.name}),b.get("/mentoring-integ/services/programmaticareas",c)},this.updateProgrammaticArea=function(c){return b.put("/mentoring-integ/services/programmaticareas",c,a("translate")("AREA_EDITED_WITH_SUCCESS"))}}]),mentoring.controller("createQuestionController",["$scope","$rootScope","questionService","resourceUtilsService",function(a,b,c,d){var e={userContext:b.userContext};a.questionTypes=[],a.questionCategories=[],a.createQuestion=function(){a.createQuestionForm.$invalid||(e.question=a.question,c.createQuestion(e).then(function(b){b.data;a.message=b.data,a.question={}})["catch"](function(b){a.message=b.data}))},a.cleanQuestion=function(){a.question={},a.message="",a.errorMessages="",a.hasErrors=[]},a.cleanQuestion(),function(){d.getQuestionTypes().then(function(b){b.data&&(a.questionTypes=b.data.questionType)}),d.getQuestionCategories().then(function(b){b.data&&(a.questionCategories=b.data.questionCategory)})}()}]),mentoring.controller("listQuestionsController",["$scope","$rootScope","questionService","resourceUtilsService",function(a,b,c,d){a.questionTypes=[],a.questionCategories=[],a.getQuestions=function(){c.getQuestions(a.questionFilter).then(function(b){if(b.data){if(!Array.isArray(b.data.question))return a.questions=[],a.questions.push(b.data.question),void(a.errorMessage="");a.questions=b.data.question,a.errorMessage=""}else a.questions=[],a.errorMessage="Nenhuma Questão encontrada para o filtro solicitado!"})},a.cleanQuestionFilter=function(){a.question={},a.questionFilter={},a.message="",a.errorMessage="",a.hasErrors=[],a.questions=[]},a.cleanQuestionFilter(),a.onSelectQuestion=function(b){a.isDisabled=!1,a.hasErrors=[],a.message="",a.errorMessage="",a.question=b,function(){d.getQuestionTypes().then(function(b){b.data&&(a.questionTypes=b.data.questionType)}),d.getQuestionCategories().then(function(b){b.data&&(a.questionCategories=b.data.questionCategory)})}()},a.editQuestion=function(){if(!a.editQuestionForm.$invalid){var d={};d.userContext=b.userContext,d.question=a.question,c.updateQuestion(d).then(function(b){var c=b.data;a.message="A Questão com o código "+c.code+" foi actulizada com sucesso!",a.isDisabled=!0})}}}]),mentoring.service("questionService",["$http","$q","$filter","spinnerService",function(a,b,c,d){this.createQuestion=function(e){return b(function(b,f){d.show("processSpinner"),a.post("/mentoring-integ/services/questions",e).success(function(a){var d=a.message;return d?void f({message:d}):void b({data:c("translate")("QUESTION_CREATED_WITH_SUCCESS")})}).error(function(a){console.log(a)})["finally"](function(){d.hide("processSpinner")})})},this.getQuestions=function(b){return a.get("/mentoring-integ/services/questions",{params:{code:b.code,question:b.question,questionType:b.questionType,questionCategory:b.questionCategory}})},this.updateQuestion=function(b){return a.put("/mentoring-integ/services/questions",b)},this.getQuestionsByForm=function(b){return a.get("/mentoring-integ/services/questions/"+b)},this.getFormQuestionsByFormId=function(b){return a.get("/mentoring-integ/services/formquestions",{params:{formId:b}})}}]),mentoring.controller("formController",["$scope","$rootScope","$state","questionService","programmaticAreaService","formService","resourceUtilsService",function(a,b,c,d,e,f,g){a.questions=[],a.sequences=[],a.questionFilter={},a.addedFormQuestions=[],a.applicables=[!0,!1],a.isDisabled=!1,a.formBeanResource={userContext:b.userContext},a.nextDetails=function(){a.createFormFrom.$invalid||(a.hasErrors=[],a.message="",a.isDisabled=!1,c.go("form.questions"))},a.back=function(){c.go("form.details")},a.addQuestion=function(b){a.addQuestionErrorMessage="";var c=_.find(a.addedFormQuestions,function(a){return a.question.code==b.code});if(c)return void(a.addQuestionErrorMessage="A questão com o código "+c.question.code+" já foi adicionada na lista");var d=a.addedFormQuestions.length+1;formQuestion={question:b,sequence:d,newSequence:d,applicable:!1},a.addedFormQuestions.push(formQuestion),a.sequences.push(d)},a.removeQuestion=function(b){_.remove(a.addedFormQuestions,function(a){return a.question.code===b.question.code});var c=1;a.sequences=[],_.forEach(a.addedFormQuestions,function(b){b.sequence=c,b.newSequence=c,a.sequences.push(c),c++})},a.onSequenceChange=function(b){a.addedFormQuestions.forEach(function(a){b.newSequence===a.sequence&&(a.newSequence=b.sequence,a.sequence=a.newSequence,b.sequence=b.newSequence)}),a.addedFormQuestions=_.sortBy(a.addedFormQuestions,function(a){return parseInt(a.newSequence)})},a.getQuestions=function(){d.getQuestions(a.questionFilter).then(function(b){if(b.data){if(!Array.isArray(b.data.question))return a.questions=[],a.questions.push(b.data.question),void(a.addQuestionErrorMessage="");a.questions=b.data.question,a.addQuestionErrorMessage=""}else a.questions=[],a.addQuestionErrorMessage="Nenhuma Questão encontrada para o filtro solicitado!"})},a.onAddQuestion=function(){a.questionFilter={},a.addQuestionErrorMessage="",a.addQuestionMessage="",a.questions=[]},a.programmaticAreas=[],a.getProgrammaticAreas=function(){e.getProgrammaticAreas({}).then(function(b){if(b.data){if(!Array.isArray(b.data.programmaticArea))return a.programmaticAreas=[],void a.programmaticAreas.push(b.data.programmaticArea);a.programmaticAreas=b.data.programmaticArea}})},a.getProgrammaticAreas(),a.createForm=function(){a.formBeanResource.form=a.form,a.formBeanResource.formQuestions=a.addedFormQuestions,a.errorMessage="",f.createForm(a.formBeanResource).then(function(b){return b.data&&b.data.message?void(a.errorMessage=b.data.message):(a.message=b.data,void(a.isDisabled=!0))})},a.cleanForm=function(){a.form={},a.message="",a.hasErrors=[],a.form={},a.addedQuestions=[]},a.cleanForm(),a.getFormTypes=function(){g.getFormTypes().then(function(b){a.formTypes=[],a.formTypes=b.data.formType})},a.getFormTypes()}]),mentoring.controller("listFormController",["$scope","$state","questionService","$rootScope","formService","programmaticAreaService","resourceUtilsService",function(a,b,c,d,e,f,g){a.form=d.form||{},a.formQuestions=[],a.sequences=[],a.questionsUpdate=[],a.applicables=["true","false"],a.questionFilter={},a.isDisabled=!1,a.formBeanResource={userContext:d.userContext},a.getFormsBySelectedFilter=function(){a.forms=e.getForms(a.formFilter).then(function(b){if(a.errorMessage="",b.data){if(!Array.isArray(b.data.form))return a.forms=[],void a.forms.push(b.data.form);a.forms=b.data.form}else a.forms=[],a.errorMessage="Nenhum Formulario foi encontrada para o filtro solicitado!"})},a.getProgrammaticAreas=function(){f.getProgrammaticAreas({}).then(function(b){if(b.data){if(!Array.isArray(b.data.programmaticArea))return a.programmaticAreas=[],void a.programmaticAreas.push(b.data.programmaticArea);a.programmaticAreas=b.data.programmaticArea}})},a.nextPage=function(){h(),b.go("formUpdate.questionsDetails")},a.back=function(){b.go("formUpdate.updateDetails")};var h=function(){c.getFormQuestionsByFormId(a.form.id).then(function(b){if(b.data){Array.isArray(b.data.formQuestion)?a.formQuestions=b.data.formQuestion:(a.formQuestions=[],a.formQuestions.push(b.data.formQuestion));var c=1;a.sequences=[],_.forEach(a.formQuestions,function(b){b.newSequence=b.sequence,a.sequences.push(c+""),c++}),a.formQuestions=_.sortBy(a.formQuestions,function(a){return parseInt(a.newSequence)})}})};a.onSequenceChange=function(b){a.formQuestions.forEach(function(a){b.newSequence===a.sequence&&(a.newSequence=b.sequence,a.sequence=a.newSequence,b.sequence=b.newSequence)}),a.formQuestions=_.sortBy(a.formQuestions,function(a){return parseInt(a.newSequence)})},a.getQuestions=function(){c.getQuestions(a.questionFilter).then(function(b){if(b.data){if(!Array.isArray(b.data.question))return a.questionsUpdate=[],a.questionsUpdate.push(b.data.question),void(a.addQuestionErrorMessage="");a.questionsUpdate=b.data.question,a.addQuestionErrorMessage=""}else a.questionUpdate=[],a.addQuestionErrorMessage="Nenhuma Questão encontrada para o filtro solicitado!"})},a.onAddQuestion=function(){a.questionFilter={},a.addQuestionErrorMessage="",a.addQuestionMessage="",a.questionsUpdate=[]},a.addQuestion=function(b){a.addQuestionErrorMessage="";var c=_.find(a.formQuestions,function(a){return a.question.code==b.code});if(c)return void(a.addQuestionErrorMessage="A questão com o código "+c.question.code+" já foi adicionada na lista");var d=a.formQuestions.length+1;formQuestion={question:b,sequence:d,newSequence:d,applicable:"false"},a.formQuestions.push(formQuestion),a.sequences.push(d)},a.updateForm=function(){a.formBeanResource.form=a.form,a.formBeanResource.formQuestions=a.formQuestions,a.errorMessage="",e.updateForm(a.formBeanResource).then(function(b){return b.data&&b.data.message?void(a.errorMessage=b.data.message):(a.message=b.data,a.questions=[],void(a.isDisabled=!0))})},a.removeQuestion=function(b){_.remove(a.formQuestions,function(a){return a.question.code===b.question.code});var c=1;a.sequences=[],_.forEach(a.formQuestions,function(b){b.sequence=c,b.newSequence=c,a.sequences.push(c),c++})},a.getProgrammaticAreas(),a.cleanFormFilter=function(){a.message="",a.formFilter={},a.errorMessage="",a.forms=[],a.addedQuestions=[]},a.onSelectForm=function(c){d.form=c,a.hasErrors=[],a.isDisabled=!1,b.go("formUpdate.updateDetails")},a.cleanFormFilter(),a.getFormTypes=function(){g.getFormTypes().then(function(b){a.formTypes=[],a.formTypes=b.data.formType})},a.getFormTypes()}]),mentoring.service("formService",["$filter","requestProcessService",function(a,b){this.createForm=function(c){return b.post("/mentoring-integ/services/forms",c,a("translate")("FORM_CREATED_WITH_SUCESS"))},this.updateForm=function(c){return b.put("/mentoring-integ/services/forms",c,a("translate")("FORM_EDITED_WITH_SUCESS"))},this.getForms=function(a){var c={code:a.code,name:a.name,programmaticAreaCode:a.programmaticArea?a.programmaticArea.code:a.programmaticArea};return b.get("/mentoring-integ/services/forms",c)}}]),mentoring.controller("homeController",["$scope","$filter","mentorshipService",function(a,b,c){a.submissions=[],a.removeDuplications=function(a){var b=[];return b=a.filter(function(a,b,c){return c.indexOf(a)==b})},a.getElements=function(b,c){var d=[];return d=c.map(function(a){return a[b]}),a.removeDuplications(d)};var d="DIE",e="rgba(255,99,132,1)",f="rgba(54, 162, 235, 1)";!function(){c.findSubmitedSessionsPerHealthFacility().then(function(b){a.submissions=b.data.submitedSessions;var c=a.getElements("district",a.submissions),g=a.getElements("programmaticArea",a.submissions),h=[];g.forEach(function(b){var c=a.submissions.filter(function(a){return a.programmaticArea===b}),g={label:b,data:c.map(function(a){return a.totalSubmited}),backgroundColor:b===d?e:f};h.push(g)});var i=document.getElementById("submissionChart");new Chart(i,{type:"bar",data:{labels:c,datasets:h},options:{scaleShowVerticalLines:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}})})["catch"](function(a){console.log(a)})}()}]),mentoring.controller("loginController",["$scope","$rootScope","$cookies","$location","authService",function(a,b,c,d,e){a.username="",a.password="",a.errorMessage="";var f={};a.login=function(){return a.loginForm.$invalid?void(a.errorMessage=""):(f.username=a.username,f.password=a.password,void e.login(f).then(function(a){c.putObject("usercontext",a),d.path("/home")})["catch"](function(b){console.log(b),a.errorMessage=b.message,a.username="",a.password="",f={}}))},a.logout=function(){c.remove("usercontext"),d.path("/login"),b.visible=!1}}]),mentoring.service("authService",["$http","$q","spinnerService",function(a,b,c){this.login=function(d){return b(function(b,e){c.show("processSpinner"),a.post("/account-manager-web/services/users",d).success(function(a){var c=a.message;return c?void e({message:c}):void b({data:a})}).error(function(a){console.log(a)})["finally"](function(){c.hide("processSpinner")})})}}]),mentoring.controller("mentoringProcessController",["$scope","$rootScope","$state","mentorshipService","formService","questionService","tutorService","tutoredService","resourceUtilsService","districtSevice","healthFacilityService",function(a,b,c,d,e,f,g,h,i,j,k){function l(a){var b=a.getDay();1==b.toString().length&&(b="0"+b);var c=a.getMonth()+1;1==c.toString().length&&(c="0"+c);var d=a.getFullYear(),e=a.getHours();1==e.toString().length&&(e="0"+e);var f=a.getMinutes();1==f.toString().length&&(f="0"+f);var g=a.getSeconds();return 1==g.toString().length&&(g="0"+g),b+"-"+c+"-"+d+" "+e+":"+f+":"+g}a.hasErrors=[],a.questionId=0,a.questions=[],a.question={},a.form={},a.formFilter={},a.hasForm=!1,a.tutor={},a.tutorFilter={},a.tutors=[],a.tutored={},a.tutoredFilter={},a.tutoreds=[],a.province="",a.provinces=[],a.district={},a.districts=[],a.healthFacilities=[],a.message="",a.errorMessageDialog="",a.mentorship={},a.mentorship.startDate=l(new Date),a.isDisabled=!1;var m={userContext:b.userContext};a.next=function(){a.answerQuestions.$invalid||(a.hasErrors=[],a.questionId++,a.question=a.questions[a.questionId],c.go("mentoringProcess.questions",{questionId:a.questionId}))},a.previews=function(){a.questionId--,a.question=a.questions[a.questionId],c.go("mentoringProcess.questions",{questionId:a.questionId})},a.showNextButton=function(){return 0===a.questionId||a.questionId!==a.questions.length-1},a.showPreviewsButton=function(){return 0!==a.questionId},a.saveMentoringProcess=function(){if(a.errorMessage="",!a.answerQuestions.$invalid){if(!a.tutor.code)return void(a.errorMessage="O Tutor deve ser seleccionado!");if(!a.tutored.code)return void(a.errorMessage="O Tutorando deve ser seleccionado!");if(!a.form.code)return void(a.errorMessage="O Formulario a preencher deve ser seleccionado!");a.mentorship.tutor=a.tutor,a.mentorship.tutored=a.tutored,a.mentorship.endDate=l(new Date),m.mentorship=a.mentorship,m.questions=a.questions,m.form=a.form,d.createMentorship(m).then(function(b){a.message=b.data,a.isDisabled=!0})}},a.getFormsBySelectedFilter=function(){a.forms=e.getForms(a.formFilter).then(function(b){if(a.errorMessageDialog="",b.data){if(!Array.isArray(b.data.form))return a.forms=[],void a.forms.push(b.data.form);a.forms=b.data.form}else a.forms=[],a.errorMessageDialog="Nenhuma Formulario foi encontrada para o filtro solicitado!"})},a.selectedForm=function(b){a.form=b,a.hasForm=!0,a.questionId=0,f.getQuestionsByForm(b.code).then(function(d){if(d.data){if(!Array.isArray(d.data.question))return a.questions=[],
void a.questions.push(d.data.question);a.questions=d.data.question,a.question=a.questions[a.questionId]}a.messageDialog="O formulário "+b.name+" foi seleccionado!",c.go("mentoringProcess.questions",{questionId:a.questionId})})},a.onOpenFormsDialog=function(){a.formFilter={},a.errorMessageDialog="",a.messageDialog="",a.forms=[]},a.onSelectTutor=function(b){a.tutor=b,a.messageDialog="O Tutor "+b.name+" "+b.surname+" foi seleccionado!"},a.onOpenTutorDialog=function(){a.messageDialog="",a.errorMessageDialog="",a.tutors=[],a.tutorFilter={}},a.onSelectTutored=function(b){a.tutored=b,a.messageDialog="O Tutorando "+b.name+" "+b.surname+" foi seleccionado!"},a.onOpenTutoredDialog=function(){a.messageDialog="",a.errorMessageDialog="",a.tutoreds=[],a.tutoredFilter={}},a.getTutorsBySelectedFilter=function(){a.tutors=g.getTutors(a.tutorFilter).then(function(b){if(a.errorMessageDialog="",b.data){if(!Array.isArray(b.data.tutor))return a.tutors=[],void a.tutors.push(b.data.tutor);a.tutors=b.data.tutor}else a.tutors=[],a.errorMessageDialog="Nenhuma Tutor foi encontrada para o filtro solicitado!"})},a.getTutoredsBySelectedFilter=function(){a.tutoreds=h.getTutoreds(a.tutoredFilter).then(function(b){if(a.errorMessageDialog="",b.data){if(!Array.isArray(b.data.tutored))return a.tutoreds=[],void a.tutoreds.push(b.data.tutored);a.tutoreds=b.data.tutored}else a.tutoreds=[],a.errorMessageDialog="Nenhuma Tutorando foi encontrada para o filtro solicitado!"})},a.clean=function(){a.hasErrors=[],a.form={},a.hasForm=!1,a.province="",a.district={},a.message="",a.mentorship={},a.mentorship.startDate=l(new Date),a.isDisabled=!1,a.tutor={},a.tutored={},a.form={},a.formFilter={},a.hasForm=!1,a.questions=[],a.question={},a.message="",a.errorMessage="",a.districts=[],a.healthFacilities=[]},function(){i.getProvinces().then(function(b){a.provinces=b.data.province})}(),function(){i.getMonths().then(function(b){a.months=b.data.month})}(),a.onSelectProvince=function(){j.getDistrictsByProvince(a.province).then(function(b){a.districts=[],a.healthFacilities=[],b.data&&(a.districts=b.data.district)})},a.onSelectDistrict=function(){k.getHealthFacilitiesByDistrictId(a.district.id).then(function(b){a.healthFacilities=[],b.data&&(a.healthFacilities=b.data.healthFacility)})}}]),mentoring.controller("listMentoringProcessController",["$scope","$rootScope","$state","mentorshipService","formService","questionService","tutorService","tutoredService","resourceUtilsService","districtSevice","healthFacilityService",function(a,b,c,d,e,f,g,h,i,j,k){({userContext:b.userContext});a.mentorshipFilter={},a.mentorship={},a.getTutoredsBySelectedFilter=function(){a.mentorships=d.getMentorshipService(a.mentorshipFilter).then(function(b){if(b.data){if(!Array.isArray(b.data.mentorship))return a.mentorships=[],void a.mentorships.push(b.data.mentorship);a.mentorships=b.data.mentorship}else a.mentorships=[],a.errorMessage="Nenhum Processo encontrado para o filtro solicitado!"})},a.cleanMentorship=function(){a.mentorshipFilter={},a.mentorships=[],a.errorMessage=""},a.findAnswersByMentorship=function(b){a.mentorship=b,a.answers=[],d.getAnswersByMentorshipUuid(b.uuid).then(function(b){a.answers=b.data.answerBeanResource})["catch"](function(a){console.log(a)})}}]),mentoring.service("mentorshipService",["$filter","requestProcessService",function(a,b){this.createMentorship=function(c){return b.post("/mentoring-integ/services/mentorships",c,a("translate")("MENTORING_CREATED_WITH_SUCCESS"))},this.getMentorshipService=function(a){var c={code:a.code,tutor:a.tutor,tutored:a.tutored,form:a.form,healthFacility:a.healthFacility};return b.get("/mentoring-integ/services/mentorships",c)},this.getAnswersByMentorshipUuid=function(a){return b.get("/mentoring-integ/services/answers/"+a)},this.findSubmitedSessionsPerHealthFacility=function(){return b.get("/mentoring-integ/services/mentorships/sessions")}}]),mentoring.service("carrerService",["$http",function(a){this.getCarrerByCarrerType=function(b){return a.get("/mentoring-integ/services/careers/"+b)}}]),mentoring.controller("sampleIndicatorsController",["$scope","$filter","reportsService","resourceUtilsService","districtSevice","healthFacilityService",function(a,b,c,d,e,f){a.sampleIndicators=[],a.sampleForms=[],a.filter={district:{},healthFacility:{},form:{}},a.districts=[],a.healthFacilities=[],a.reportHeader={district:b("translate")("DISTRICT"),healthFacility:b("translate")("HEALTH_FACILITY"),form:b("translate")("FORM"),collectedSamples:b("translate")("COLLECTED_SAMPLES"),transportedSamples:b("translate")("REFFERED_SAMPLES"),rejectedSamples:b("translate")("REJECTED_SAMPLES"),receivedSamples:b("translate")("RECEIVED_SAMPLES")},a.fileName=b("translate")("SAMPLE_INDICATORS"),a.findSampleindicatorsBySelectedFilter=function(){a.sampleIndicators=[],c.getSampleIndicators(a.filter).then(function(b){a.sampleIndicators=b.data.sampleIndicator})["catch"](function(a){console.log(a)})},function(){d.getProvinces().then(function(b){a.provinces=b.data.province}),c.getSampleForms().then(function(b){a.sampleForms=b.data.form})["catch"](function(a){console.log(a)})}(),a.onSelectProvince=function(){e.getDistrictsByProvince(a.filter.province).then(function(b){a.districts=[],a.healthFacilities=[],b.data&&(a.districts=b.data.district)})},a.onSelectDistrict=function(){f.getHealthFacilitiesByDistrictId(a.filter.district.id).then(function(b){a.healthFacilities=[],b.data&&(a.healthFacilities=b.data.healthFacility)})},a.clean=function(){a.sampleIndicators=[],a.districts=[],a.healthFacilities=[],a.filter={district:{},healthFacility:{},form:{}}}}]),mentoring.controller("performedSessionsController",["$scope","$filter","reportsService","resourceUtilsService","districtSevice","healthFacilityService","programmaticAreaService","formService",function(a,b,c,d,e,f,g,h){a.clean=function(){a.performedSessions=[],a.mentoringForms=[],a.districts=[],a.healthFacilities=[],a.errorMessage="",a.filter={district:{},healthFacility:{},form:{},programmaticArea:{}}},a.clean(),a.reportHeader={district:b("translate")("DISTRICT"),healthFacility:b("translate")("HEALTH_FACILITY"),formName:b("translate")("FORM"),totalPerformed:b("translate")("TOTAL")},a.fileName=b("translate")("PERFORMED_SESSIONS"),a.findPerformedSessionsBySelectedFilter=function(){a.performedSessions=[],a.errorMessage="",c.getPerformedSessions(a.filter).then(function(b){a.performedSessions=b.data.performedSession})["catch"](function(b){a.errorMessage=b.data,console.log(b)})},function(){d.getProvinces().then(function(b){a.provinces=b.data.province})["catch"](function(a){console.log(a)}),g.getProgrammaticAreas().then(function(b){a.programmaticAreas=b.data.programmaticArea})["catch"](function(a){console.log(a)})}(),a.onSelectProvince=function(){e.getDistrictsByProvince(a.filter.province).then(function(b){a.districts=[],a.healthFacilities=[],b.data&&(a.districts=b.data.district)})},a.onSelectDistrict=function(){f.getHealthFacilitiesByDistrictId(a.filter.district.id).then(function(b){a.healthFacilities=[],b.data&&(a.healthFacilities=b.data.healthFacility)})},a.onSelectProgrammaticArea=function(){a.forms=[],h.getForms({programmaticArea:a.filter.programmaticArea}).then(function(b){return Array.isArray(b.data.form)?(a.forms=b.data.form,void(a.forms=a.forms.filter(function(a){return"MENTORING"===a.formType}))):void a.forms.push(b.data.form)})["catch"](function(a){console.log(a)})}}]),mentoring.controller("analysisTablesController",["$scope","$filter","reportsService","resourceUtilsService","districtSevice",function(a,b,c,d,e){a.analysisTables=[],a.filter={district:{}},a.districts=[],a.reportHeader={form:b("translate")("FORM"),collectedSamples:b("translate")("COLLECTED_SAMPLES"),referredSamples:b("translate")("REFFERED_SAMPLES"),rejectedSamples:b("translate")("REJECTED_SAMPLES"),receivedResult:b("translate")("RECEIVED_SAMPLES"),transportation:b("translate")("TRANSPORT_%"),rejection:b("translate")("REJECTION_%"),result:b("translate")("RESULT_%"),totalResult:b("translate")("TOTAL_RESULT_%")},a.fileName=b("translate")("ANALYSIS_TABLE"),a.findAnalysisTablesBySelectedFilter=function(){a.analysisTables=[],c.getAnalysisTables(a.filter).then(function(b){a.analysisTables=b.data.analysisTable})["catch"](function(a){console.log(a)})},function(){d.getProvinces().then(function(b){a.provinces=b.data.province})["catch"](function(a){console.log(a)})}(),a.onSelectProvince=function(){e.getDistrictsByProvince(a.filter.province).then(function(b){a.districts=[],b.data&&(a.districts=b.data.district)})},a.clean=function(){a.analysisTables=[],a.districts=[],a.filter={district:{}}}}]),mentoring.service("reportsService",["requestProcessService",function(a){this.getSampleIndicators=function(b){var c={districtUuid:b.district.uuid,healthFacilityUuid:b.healthFacility.uuid,formUuid:b.form.uuid,startDate:b.startDate,endDate:b.endDate};return a.get("/mentoring-integ/services/indicators/sample-indicators",c)},this.getSampleForms=function(){return a.get("/mentoring-integ/services/forms/sample-forms")},this.getPerformedSessions=function(b){var c={districtUuid:b.district.uuid,healthFacilityUuid:b.healthFacility.uuid,programmaticAreaUuid:b.programmaticArea.uuid,formUuid:b.form.uuid,startDate:b.startDate,endDate:b.endDate};return a.get("/mentoring-integ/services/mentorships/performed-sessions",c)},this.getAnalysisTables=function(b){var c={districtUuid:b.district.uuid,startDate:b.startDate,endDate:b.endDate};return a.get("/mentoring-integ/services/indicators/analysis-tables",c)}}]);